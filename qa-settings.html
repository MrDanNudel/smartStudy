<!DOCTYPE html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>×”×’×“×¨×•×ª â€” ×©××œ×•×ª-×ª×©×•×‘×•×ª</title>

    <!-- ×¢×™×¦×•×‘ -->
    <link rel="stylesheet" href="css/qa-settings.css" />

    <style>
      body {
        font-family: "Assistant", sans-serif;
        text-align: center;
        color: var(--text, #e8f6ff);
        background: radial-gradient(circle at top, #041a2e, #020b15);
      }

      .back-btn,
      .home-btn {
        position: absolute;
        top: 32px;
        padding: 10px 18px;
        border: 1px solid rgba(120, 220, 255, 0.35);
        border-radius: 18px;
        background: rgba(19, 32, 54, 0.55);
        color: var(--text, #e8f6ff);
        font-weight: 600;
        cursor: pointer;
        transition: 0.25s ease;
        box-shadow: 0 0 8px rgba(0, 0, 0, 0.2);
        backdrop-filter: blur(8px);
      }

      .back-btn:hover,
      .home-btn:hover {
        background: rgba(19, 32, 54, 0.8);
        transform: scale(1.05);
      }

      .back-btn {
        left: 32px;
      }

      .home-btn {
        right: 32px;
      }

      .hero h1 {
        font-size: 26px;
        margin-bottom: 8px;
        color: var(--text, #e8f6ff);
      }

      .subject-highlight {
        display: block;
        font-size: 50px;
        font-weight: 800;
        color: #4ec8ff;
        margin-top: 8px;
        text-shadow: 0 0 16px rgba(80, 200, 255, 0.5);
      }

      select.select {
        background: #0b1b31;
        border: 1px solid rgba(120, 220, 255, 0.25);
        border-radius: 12px;
        padding: 10px 14px;
        color: var(--text);
        font-size: 16px;
        outline: none;
      }

      select.select:focus {
        border-color: #89e2ff;
      }

      .hint.warning {
        color: #5fd9ff;
        text-shadow: 0 0 10px rgba(95, 217, 255, 0.7);
        animation: glow 2s infinite ease-in-out;
      }

      @keyframes glow {
        0% {
          opacity: 0.6;
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0.6;
        }
      }

      h2 {
        color: #b7dfff;
      }

      .panel {
        margin-top: 80px;
      }

      #clearStorageBtn {
        margin-top: 30px;
        padding: 8px 18px;
        border-radius: 14px;
        background: rgba(255, 60, 60, 0.2);
        border: 1px solid rgba(255, 100, 100, 0.4);
        color: #ff8080;
        font-weight: 600;
        cursor: pointer;
        transition: 0.25s ease;
      }

      #clearStorageBtn:hover {
        background: rgba(255, 80, 80, 0.35);
        transform: scale(1.05);
      }

      /* ğŸ”¹ ×ª×™×‘×ª ×¡×˜×˜×•×¡ ×œ××¢×œ×” ××™××™×Ÿ */
      .status-bar {
        position: absolute;
        top: 20px;
        right: 180px;
        background: rgba(19, 32, 54, 0.65);
        border: 1px solid rgba(120, 220, 255, 0.25);
        border-radius: 14px;
        padding: 10px 16px;
        color: #dff8ff;
        font-size: 15px;
        display: flex;
        flex-direction: column;
        gap: 4px;
        text-align: right;
        box-shadow: 0 0 10px rgba(0, 200, 255, 0.3);
        backdrop-filter: blur(8px);
      }

      .status-bar span {
        display: block;
      }

      .status-bar .hard {
        color: #ff7b7b;
      }

      .status-bar .easy {
        color: #7dffb2;
      }
    </style>
  </head>

  <body>
    <div class="wrap">
      <button class="back-btn" onclick="history.back()">â† ×œ×¢××•×“ ×”×§×•×“×</button>
      <button class="home-btn" onclick="window.location.href='index.html'">
        ×œ×¢××•×“ ×”×¨××©×™ â†’
      </button>

      <!-- ğŸ”¹ ×ª×™×‘×ª ×¡×˜×˜×•×¡ -->
      <div class="status-bar" id="statusBar">
        <span class="hard">ğŸ’¾ ×©××œ×•×ª ×§×©×•×ª: 0</span>
        <span class="easy">ğŸ’¡ ×©××œ×•×ª ×§×œ×•×ª: 0</span>
      </div>

      <header class="hero">
        <h1>
          ×©××œ×•×ª
          <span id="subjectLabel" class="subject-highlight">â€”</span>
        </h1>
        <p class="sub">×‘×—×¨/×™ ××ª ×¡×•×’ ×”×ª×¨×’×•×œ ×•××¡×¤×¨ ×”×©××œ×•×ª ×”×¨×¦×•×™.</p>
      </header>

      <section class="panel">
        <h2>×”×’×“×¨×•×ª ×ª×¨×’×•×œ ×©××œ×•×ª-×ª×©×•×‘×•×ª</h2>

        <div class="grid">
          <div class="field">
            <label for="questionMode">×‘×—×¨ ×¡×•×’ ×©××œ×•×ª</label>
            <select id="questionMode" class="select">
              <option value="all">ğŸ“š ×›×œ ×”×©××œ×•×ª ×‘× ×•×©×</option>
              <option value="hard">ğŸ’ª ×©××œ×•×ª ×©×¡×•×× ×• ×›×××ª×’×¨×•×ª</option>
              <option value="easy">ğŸ’¡ ×©××œ×•×ª ×©×¡×•×× ×• ×›×§×œ×•×ª</option>
            </select>
            <small class="hint">×‘×—×¨ ××™×œ×• ×©××œ×•×ª ×‘×¨×¦×•× ×š ×œ×ª×¨×’×œ</small>
          </div>

          <div class="field">
            <label for="numQuestions">×”×’×“×¨ ××¡×¤×¨ ×©××œ×•×ª</label>
            <input
              id="numQuestions"
              type="number"
              min="1"
              step="1"
              value="10"
            />
            <small id="numHint" class="hint">1â€“10</small>
          </div>
        </div>

        <div class="actions">
          <button id="startBtn" class="primary">×”×ª×—×œ ×ª×¨×’×•×œ!</button>
          <button id="clearStorageBtn">× ×§×” ×©××œ×•×ª ××¡×•×× ×•×ª</button>
        </div>
      </section>

      <footer class="foot">
        <span>Smart Study â€¢ Q&A Mode</span>
      </footer>
    </div>

    <script src="data/qa-bank.js"></script>

    <script>
      console.log("âœ… QA Settings script loaded and running!");

      function getSubjectKey() {
        const url = new URL(window.location.href);
        return url.searchParams.get("subject") || "chemistry";
      }

      const subjectTitles = {
        anatomy: "×× ×˜×•××™×”",
        chemistry: "×›×™××™×”",
        psychology: "×¤×¡×™×›×•×œ×•×’×™×”",
        literacy: "××•×¨×™×™× ×•×ª ×©×¤×ª×™×ª",
        basketball: "×™×¡×•×“×•×ª ×‘×›×“×•×¨×¡×œ",
        athletics: "×™×¡×•×“×•×ª ×‘××ª×œ×˜×™×§×”",
        football: "×™×¡×•×“×•×ª ×‘×›×“×•×¨×’×œ",
        statistics1: "×¡×˜×˜×™×¡×˜×™×§×” â€“ ×—×œ×§ ××³",
        physics: "×¤×™×–×™×§×”",
      };

      const qaBanks = window.qaBanks || {};

      const els = {
        subjectLabel: document.getElementById("subjectLabel"),
        numInput: document.getElementById("numQuestions"),
        numHint: document.getElementById("numHint"),
        modeSelect: document.getElementById("questionMode"),
        startBtn: document.getElementById("startBtn"),
        clearBtn: document.getElementById("clearStorageBtn"),
        statusBar: document.getElementById("statusBar"),
      };

      (function init() {
        const subjectKey = getSubjectKey();
        const title = subjectTitles[subjectKey] || subjectKey;
        els.subjectLabel.textContent = title;

        const allQuestions = qaBanks[subjectKey] || [];
        const hardQTexts = JSON.parse(
          localStorage.getItem("hardQuestions") || "[]"
        );
        const easyQTexts = JSON.parse(
          localStorage.getItem("easyQuestions") || "[]"
        );

        const hardQuestions = allQuestions.filter((q) =>
          hardQTexts.includes(q.q)
        );
        const easyQuestions = allQuestions.filter((q) =>
          easyQTexts.includes(q.q)
        );

        console.groupCollapsed("ğŸ“Š QA Settings Debug Info");
        console.log("× ×•×©×:", subjectKey);
        console.log("×¡×”×´×› ×©××œ×•×ª:", allQuestions.length);
        console.log("ğŸ’ª ×§×©×•×ª:", hardQuestions.length);
        console.log("ğŸ’¡ ×§×œ×•×ª:", easyQuestions.length);
        console.groupEnd();

        // ×¢×“×›×•×Ÿ ×ª×™×‘×ª ×”×¡×˜×˜×•×¡
        function updateStatusBar() {
          els.statusBar.querySelector(
            ".hard"
          ).textContent = `ğŸ’¾ ×©××œ×•×ª ×§×©×•×ª: ${hardQuestions.length}`;
          els.statusBar.querySelector(
            ".easy"
          ).textContent = `ğŸ’¡ ×©××œ×•×ª ×§×œ×•×ª: ${easyQuestions.length}`;
        }
        updateStatusBar();

        let selectedQuestions = [...allQuestions];
        let currentMode = "all";

        function updateRange() {
          if (currentMode === "hard") selectedQuestions = hardQuestions;
          else if (currentMode === "easy") selectedQuestions = easyQuestions;
          else selectedQuestions = allQuestions;

          const count = selectedQuestions.length;
          if (count === 0) {
            els.numHint.textContent = "âš ï¸ ××™×Ÿ ×©××œ×•×ª ×–××™× ×•×ª ×‘××¦×‘ ×–×”";
            els.numHint.classList.add("warning");
            els.numInput.value = "";
            els.numInput.disabled = true;
            els.startBtn.disabled = true;
            return;
          }

          els.numHint.classList.remove("warning");
          els.numInput.disabled = false;
          els.numInput.max = count;
          els.numInput.min = 1;
          els.numInput.value = Math.min(
            parseInt(els.numInput.value) || 1,
            count
          );
          els.numHint.textContent = `1â€“${count}`;
          els.startBtn.disabled = false;
        }

        els.modeSelect.addEventListener("change", () => {
          currentMode = els.modeSelect.value;
          updateRange();
        });

        els.numInput.addEventListener("input", () => {
          const max = parseInt(els.numInput.max) || 1;
          const val = Math.max(
            1,
            Math.min(parseInt(els.numInput.value) || 1, max)
          );
          els.numInput.value = val;
        });

        els.startBtn.addEventListener("click", () => {
          const count = parseInt(els.numInput.value) || 1;
          const settings = {
            mode: currentMode,
            subject: subjectKey,
            numQuestions: count,
          };
          localStorage.setItem("qa_settings", JSON.stringify(settings));
          window.location.href = `qa.html?subject=${subjectKey}&mode=${currentMode}&questions=${count}`;
        });

        els.clearBtn.addEventListener("click", () => {
          if (confirm("×œ× ×§×•×ª ××ª ×›×œ ×”×©××œ×•×ª ×©×¡×•×× ×• ×›×§×œ×•×ª ××• ×§×©×•×ª?")) {
            localStorage.setItem("hardQuestions", "[]");
            localStorage.setItem("easyQuestions", "[]");
            alert("âœ… ×›×œ ×”×¡×™××•× ×™× × ××—×§×• ×‘×”×¦×œ×—×”!");
            hardQuestions.length = 0;
            easyQuestions.length = 0;
            updateStatusBar();
            updateRange();
          }
        });

        updateRange();
      })();
    </script>
  </body>
</html>
